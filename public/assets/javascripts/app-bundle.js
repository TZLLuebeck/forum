var app,dependencies;dependencies=["ui.router","restangular","ngStorage","permission","permission.ui","ngFileUpload","toaster"],(app=angular.module("mediMeet",dependencies)).config(["$httpProvider",function(e){return e.interceptors.push("tokenInterceptor"),e.interceptors.push("responseInterceptor")}]),app.run(["User","TokenContainer","$rootScope","$state","$stateParams","Rails","$transitions",function(e,t,r,n,o,s,i){return r.$state=n,r.$stateParams=o,i.onBefore({},function(e){return r.lastState=e.from(),r.lastStateParams=e.params("from")})}]);var indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("mediMeet").run(["$q","PermRoleStore","User",function(e,t,r){return t.defineRole("anonymous",function(e){return!r.isAuthenticated()}),t.defineRole("user",function(t){var n;return n=e.defer(),r.getRoles().then(function(e){return e||n.reject(),indexOf.call(e,"user")>=0?n.resolve():n.reject()},function(){return n.reject()}),n.promise}),t.defineRole("admin",function(t){var n;return n=e.defer(),r.getRoles().then(function(e){return e||n.reject(),indexOf.call(e,"admin")>=0?n.resolve():n.reject()},function(){return n.reject()}),n.promise}),t.defineRole("student",function(t){var n;return n=e.defer(),r.getRoles().then(function(e){return e||n.reject(),indexOf.call(e,"student")>=0?n.resolve():n.reject()},function(){return n.reject()}),n.promise}),t.defineRole("institute",function(t){var n;return n=e.defer(),r.getRoles().then(function(e){return e||n.reject(),indexOf.call(e,"institute")>=0?n.resolve():n.reject()},function(){return n.reject()}),n.promise}),t.defineRole("startup",function(t){var n;return n=e.defer(),r.getRoles().then(function(e){return e||n.reject(),indexOf.call(e,"startup")>=0?n.resolve():n.reject()},function(){return n.reject()}),n.promise}),t.defineRole("company",function(t){var n;return n=e.defer(),r.getRoles().then(function(e){return e||n.reject(),indexOf.call(e,"company")>=0?n.resolve():n.reject()},function(){return n.reject()}),n.promise})}]),angular.module("mediMeet").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,r){return console.log("Configuring Routes."),t.otherwise(function(e){return e.get("$state").go("root.home")}),r.html5Mode(!0),r.hashPrefix(""),e.state("root",{url:"",abstract:!0,views:{"header@":{templateUrl:"assets/views/common/nav.html",controller:"NavCtrl",controllerAs:"nav"},"footer@":{templateUrl:"assets/views/common/footer.html"}},resolve:{identity:["TokenContainer","User","$rootScope",function(e,t,r){if(e.get())return t.retrieveUser().then(function(e){return t.user=e,console.log("User Retrieved from Token"),r.$broadcast("user:stateChanged")})}]}}).state("match",{url:"/match/{id}",onEnter:["$state","$stateParams",function(e,t){return console.log(t.id),e.go("root.interest.hidden",{id:t.id})}]}).state("root.home",{url:"/",views:{"body@":{templateUrl:"assets/views/common/home.html",controller:"HomeCtrl",controllerAs:"home"}}}).state("root.explore",{url:"/explore",params:{category:null},views:{"body@":{templateUrl:"assets/views/common/search.html",controller:"SearchCtrl",controllerAs:"search"}},resolve:{category:["$stateParams","$state",function(e,t){if(e.category)return e.category}],initials:["Interests","$stateParams","$state",function(e,t,r){return t.category?e.getByCategory(t.category).then(function(e){return e},function(e){return r.go("root.home")}):(r.go("root.home"),null)}]}}).state("root.impressum",{url:"/impressum",views:{"body@":{templateUrl:"assets/views/common/impressum.html"}}}).state("root.kontakt",{url:"/kontakt",views:{"body@":{templateUrl:"assets/views/common/kontakt.html"}}}).state("root.agb",{url:"/nutzungsbedingungen",views:{"body@":{templateUrl:"assets/views/common/agb.html"}}}).state("root.antimaas",{url:"/datenschutz",views:{"body@":{templateUrl:"assets/views/common/datenschutz.html"}}}).state("root.register",{url:"/registration",views:{"body@":{templateUrl:"assets/views/users/register.html",controller:"RegistrationCtrl",controllerAs:"reg"}},resolve:{companies:["Company",function(e){return e.getAll().then(function(e){return e},function(e){return e})}]}}).state("root.login",{url:"/login",views:{"body@":{templateUrl:"assets/views/users/login.html",controller:"LoginCtrl",controllerAs:"login"}}}).state("root.profile",{url:"/profile",params:{id:null},views:{"body@":{templateUrl:"assets/views/users/profile.html",controller:"ProfileCtrl",controllerAs:"profile"}},resolve:{mydata:["User","$stateParams","$state",function(e,t,r){return e.getUserPacket(t.id).then(function(e){return e.data},function(e){return r.go("root.home")})}],posts:["User","$stateParams",function(e,t){return e.getInterests(t.id).then(function(e){return e.data},function(e){return e})}]}}).state("root.profile.edit",{url:"/edit",params:{id:null},views:{"body@":{templateUrl:"assets/views/users/edit.html",controller:"ProfileEditCtrl",controllerAs:"predit"}},data:{permissions:{except:"anonymous",redirectTo:"root.home"}}}).state("root.profile.interests",{url:"/interests",views:{"subbody@":{templateUrl:"assets/views/interests/list.html",controller:"InterestsCtrl",controllerAs:"interests"}}}).state("root.company.cmpinterests",{url:"/companies/view/interests",params:{id:null},views:{"subbody@":{templateUrl:"assets/views/interests/company.html",controller:"CompanyInterestCtrl",controllerAs:"cmpint"}}}).state("root.interest",{url:"",abstract:!0,params:{id:null},views:{"body@":{templateUrl:"assets/views/interests/view.html",controller:"InterestCtrl",controllerAs:"intrst"}},resolve:{info:["Interests","$stateParams","$state",function(e,t,r){return e.getInterest(t.id).then(function(e){return e.data},function(e){if(401!==e.status)return r.go("root.home")})}]}}).state("root.interest.hidden",{url:"/interest",templateUrl:"assets/views/interests/hidden.html",controller:"InterestHiddenCtrl",controllerAs:"ctrl"}).state("root.interest.revealed",{url:"/interest/contact",data:{permissions:{except:"anonymous",redirectTo:"root.interest.hidden"}},templateUrl:"assets/views/interests/revealed.html",controller:"InterestRevealedCtrl",controllerAs:"ctrl",resolve:{contact:["Interests","$stateParams",function(e,t){return e.makeContact(t.id).then(function(e){return e.data},function(e){return e})}]}}).state("root.interest.createinterest",{url:"/create",views:{"body@":{templateUrl:"assets/views/interests/create.html",controller:"NewPostCtrl",controllerAs:"npost"}},data:{permissions:{except:"anonymous",redirectTo:"root.register"}}}).state("root.interest.editinterest",{url:"/edit",params:{id:null},data:{permissions:{except:"anonymous",redirectTo:"root.home"}},views:{"body@":{templateUrl:"assets/views/interests/edit.html",controller:"InterestEditCtrl",controllerAs:"intedit"}}}).state("root.companies",{url:"/companies",views:{"body@":{templateUrl:"assets/views/companies/companies.html",controller:"CompaniesCtrl",controllerAs:"cmps"}},resolve:{list:["Company",function(e){return e.getApproved().then(function(e){return e},function(e){return[]})}]}}).state("root.companies.company",{url:"/view",views:{"body@":{templateUrl:"assets/views/companies/company.html",controller:"CompanyCtrl",controllerAs:"cmp"}},params:{id:null},resolve:{comp:["Company","$state","$stateParams",function(e,t,r){return r.id||t.go("root.companies"),e.getOne(r.id).then(function(e){return e.data},function(e){return t.go("root.companies")})}]}}).state("root.companies.newcomp",{url:"/create",data:{permissions:{only:"admin",redirectTo:"root.home"}},views:{"body@":{templateUrl:"assets/views/companies/create.html",controller:"NewCompanyCtrl",controllerAs:"ncomp"}}}).state("root.admin",{url:"/admin",abstract:!0,data:{permissions:{only:"admin",redirectTo:"root.home"}}}).state("root.admin.userlist",{url:"/users",views:{"body@":{templateUrl:"assets/views/admin/users.html",controller:"UserListCtrl",controllerAs:"users"}},resolve:{users:["User",function(e){return e.getAll().then(function(e){return e},function(e){return e})}]}}).state("root.admin.interestlist",{url:"/interests",views:{"body@":{templateUrl:"assets/views/admin/interests.html",controller:"InterestListCtrl",controllerAs:"interests"}},resolve:{interest:["Interests",function(e){return e.getAll().then(function(e){return e},function(e){return e})}]}}).state("root.admin.companylist",{url:"/companies",views:{"body@":{templateUrl:"assets/views/admin/companies.html",controller:"CompanyListCtrl",controllerAs:"companies"}}}).state("root.admin.statistics",{url:"/statistics",views:{"body@":{templateUrl:"assets/views/admin/statistics.html",controller:"StatisticsCtrl",controllerAs:"stats"}}})}]),angular.module("mediMeet").directive("onScrollToBottom",["$document","$window",function(e,t){return{restrict:"A",link:function(r,n,o){return e.bind("scroll",function(){if(t.pageYOffset+t.innerHeight>=e.height())return r.$apply(o.onScrollToBottom)}),r.$on("$destroy",function(){return e.unbind("scroll")})}}}]),angular.module("mediMeet").directive("tooltips",["$document","$window",function(e,t){return{restrict:"A",link:function(t,r,n){return e.bind("scroll",function(){return e.ready(function(){return $('[data-toggle="tooltip"]').tooltip(),$('[data-toggle="popover"]').popover()})})}}}]),angular.module("mediMeet").factory("Keywords",function(){return this.categories=["Hospital/IT 4.0","Medizintechnik 4.0","Facility Management 4.0","Klinische Prozesse 4.0"],this.subcategories=["Cloud/IT-Services/Big Data","Mobile Anwendungen","Daten-/Dokumentenaustausche","Cyber-Security & Privacy","Interoperabilität","Assistenzsysteme","Wartung und Service","Usability","IT-gestützte Instandhaltung","IoT im Krankenhaus","Blue/Green Hospital","Supply-Chain-Management","e-Health/Medical Apps","Digitale Versorgungsplattform","Qualitäts-/Leistungserfassung","Integrierte Prozesse"],this.keywords=["IT-Services","Digital Twin","Big Data","Connected Medical Devices","Mobile Anwendungen/Mobile Devices","Clinical Decision Support","Daten- und Dokumentenaustausch","Condition Monitoring","Cyber-Security/IT-Sicherheit","Telemedizin","Safety/Funktionssicherheit","personalisierte Medizin","Datenschutz/Privacy","elektronische Patientenakte (EPA)","IT-gestützte Instandhaltung/Computerized Maintenance","Medizingeräte/Medical Devices","Internet of Things","Cyber-physical-systems (CPS)","Sustainability/Nachhaltigkeit","Krankenhausinformationssystem (KIS)","Green-/Blue-Hospital","Predicitve Maintenance","Supply-Chain-Management","Processing","Logistik","Clinical Pathways/Behandlungspfade","Interoperabilität","Assistenzsysteme","Wartung und Service","Usability","e-Health","Medical Apps","Clinical Unified Collaboration","Qualitätsmanagement"],this.relations=[{category:"Hospital/IT 4.0",subcategories:[{subcategory:"Cloud/IT-Services/Big Data",keywords:["Cloud","IT-Services","Big Data","Internet of Things","Cyber-Security/IT-Sicherheit","Daten-und Dokumentenaustausch"]},{subcategory:"Mobile Anwendungen",keywords:["Mobile Anwendungen/Mobile Devices","Medical Apps","e-Health","Connected Medical Devices","elektronische Patientenakte (EPA)","Krankenhausinformationssystem (KIS)"]},{subcategory:"Daten-/Dokumentenaustausche",keywords:["Daten- und Dokumentenaustausch","elektronische Patientenakte (EPA)","Krankenhausinformationssystem (KIS)","Qualitätsmanagement"]},{subcategory:"Cyber-Security & Privacy",keywords:["Cyber-Security/IT-Sicherheit","Safety/Funktionssicherheit","Datenschutz/Privacy Cloud"]}]},{category:"Medizintechnik 4.0",subcategories:[{subcategory:"Interoperabilität",keywords:["Interoperabilität","Medizingeräte/Medical Devices","Connected Medical Devices"]},{subcategory:"Assistenzsysteme",keywords:["Assistenzsysteme","Cyber-physical-systems (CPS)"]},{subcategory:"Wartung und Service",keywords:["Wartung und Service","Condition Monitoring","Predicitve Maintenance"]},{subcategory:"Usability",keywords:["Usability","Connected Medical Devices","Cyber-physical-systems (CPS)","Telemedizin"]}]},{category:"Facility Management 4.0",subcategories:[{subcategory:"IT-gestützte Instandhaltung",keywords:["IT-gestützte Instandhaltung/Computerized Maintenance","Condition Monitoring","Predicitve Maintenance","Internet of Things","Smart Device"]},{subcategory:"IoT im Krankenhaus",keywords:["Internet of Things","Smart Devices","Digital Twin","Cloud","elektronische Patienteakte","connected medical device","clinical decision support","Telemedzin","Cyber-physical-systems (CPS)"]},{subcategory:"Blue/Green Hospital",keywords:["Nachhaltigkeit/Sustainability","Green-/Blue-Hospital","Supply-Chain-Management","Clinical Pathways","Internet of Things","Qualitätsmanagement"]},{subcategory:"Supply-Chain-Management",keywords:["Supply-Chain-Management","Logistik","Mobile Anwendungen/Mobile Devices","Internet of Things","Medical Apps","Qualitätsmanagement","Smart Devices"]}]},{category:"Klinische Prozesse 4.0",subcategories:[{subcategory:"e-Health/Medical Apps",keywords:["e-Health","Medical Apps","personalisierte Medizin","elektronische Patientenakte (EPA)","Telemedizin","Smart Devices","Internet of Things","Datenschutz","Usability"]},{subcategory:"Digitale Versorgungsplattform",keywords:["IT-Service","Daten- und Dokumentenaustausch","Interoperabilität","Usability","Integrierte Prozesse","Telemedizin"]},{subcategory:"Qualitäts-/Leistungserfassung",keywords:["Qualitätsmanagement","Daten- und Dokumentenaustausch","Datenschutz/Privacy","elektronische Patientenakte (EPA)"]},{subcategory:"Integrierte Prozesse",keywords:["Clinical Pathways/Behandlungspfade","Krankenhausinformationssystem (KIS)","Qualitätsmanagement"]}]}],{categories:this.categories,subcategories:this.subcategories,keywords:this.keywords,relations:this.relations}}),angular.module("mediMeet").factory("mediREST",["Rails","Restangular",function(e,t){return t.withConfig(function(t){return""+e.database,t.setBaseUrl("/api/v1"),t.setDefaultHeaders({"Content-Type":"application/json"}),t.setRequestSuffix(".json")})}]),angular.module("mediMeet").service("Company",["mediREST","$q","Upload","Rails",function(e,t,r,n){var o,s,i,a,u,c,l;return s=function(e){var n;return n=t.defer(),r.upload({url:"/api/v1/companies/",data:{data:e}}).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e)}),n.promise},a=function(){var r;return r=t.defer(),e.one("companies").get().then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise},u=function(){var r;return r=t.defer(),e.one("companies").one("approve").get().then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise},c=function(r){var n,o;return n=t.defer(),o=e.one("companies"),o.id=r,o.get().then(function(e){return n.resolve(e)},function(e){return n.reject(e)}),n.promise},l=function(e){var r;return r=t.defer(),e.put().then(function(e){return r.resolve(e)},function(e){return r.reject(e)}),r.promise},o=function(r){var n,o;return n=t.defer(),o=e.one("companies").one("approve"),o.id=r,o.put().then(function(e){return n.resolve(e)},function(e){return n.reject(e)}),n.promise},i=function(r){var n,o;return n=t.defer(),o=e.one("companies"),o.id=r,o.remove().then(function(e){return n.resolve(e)},function(e){return n.reject(e)}),n.promise},{createCompany:s,getAll:a,getApproved:u,getOne:c,update:l,approve:o,destroy:i}}]),angular.module("mediMeet").service("Helper",["$rootScope","$state",function(e,t){var r;return r=function(r){var n,o;if(n=e.lastState,o=e.lastStateParams,n)return t.go(n.name,o)},{goBack:r}}]),angular.module("mediMeet").service("Interests",["mediREST","$q",function(e,t){var r,n,o,s,i,a,u,c;return r=function(r){var n,o;return n=t.defer(),o=e.one("interests"),o.data=r,o.post().then(function(e){return console.log("Interest posted"),n.resolve(e.data)},function(e){return n.reject(e.data.error)}),n.promise},s=function(){var r;return r=t.defer(),e.one("interests").get().then(function(e){return console.log("Got Interests"),r.resolve(e.data)},function(e){return console.log("Interest Error"),r.reject(e.data.error)}),r.promise},i=function(r){var n,o,s;return n=t.defer(),o=e.one("interests").one("category"),s={category:r},o.customGET("",s).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.data)}),n.promise},a=function(r){var n,o;return n=t.defer(),o=e.one("interests"),o.id=r,o.get().then(function(e){return n.resolve(e)},function(e){return n.reject(e)}),n.promise},c=function(r){var n,o;return n=t.defer(),o=e.one("interests").one("contact"),o.id=r,o.get().then(function(e){return n.resolve(e)},function(e){return n.reject(e)}),n.promise},u=function(){var r;return r=t.defer(),e.one("interests").one("keywords").get().then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise},o=function(e){var r;return r=t.defer(),e.put().then(function(e){return console.log("editInterest"),r.resolve(e)},function(e){return r.reject(e)}),r.promise},n=function(r){var n,o;return n=t.defer(),o=e.one("interests"),o.id=r,o.remove().then(function(e){return n.resolve(e)},function(e){return n.reject(e)}),n.promise},{createInterest:r,getAll:s,getInterest:a,makeContact:c,getKeywords:u,getByCategory:i,editInterest:o,deleteInterest:n}}]),angular.module("mediMeet").service("SharedData",function(){var e,t,r,n;return e={},n=function(t,r){return e[t]=r},r=function(t){return e[t]},t=function(t){return e[t]=null},{setValue:n,getValue:r,deleteValue:t}}),angular.module("mediMeet").service("TokenContainer",["$localStorage","Rails","$rootScope","$timeout",function(e,t,r,n){var o,s,i,a,u;return u=function(t){var r,n,o;return o={token:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token},r=+new Date,n=r+1e3*o.expiresIn,e.token=angular.extend(o,{expiresAt:n})},i=function(){var e;return(e=o())?e.token:null},a=function(){var e;return(e=o())?e:null},o=function(){return e.token||null},s=function(){return delete e.token,n(function(){return r.$broadcast("user:token_invalid"),r.$broadcast("user:stateChanged")})},{get:i,getRaw:a,set:u,delete:s}}]),angular.module("mediMeet").service("User",["mediREST","$q","$http","Rails","$rootScope","Upload",function(e,t,r,n,o,s){var i,a,u,c,l,d,f,m,g,h,p,y;return y=e.one("users"),this.user=null,this.deferreds={},this.unauthorized=!0,g=function(e){var r;return r=t.defer(),s.upload({url:"/api/v1/users/",data:{data:e}}).then(function(e){return r.resolve(e.data)},function(e){return r.reject(e)}),r.promise},a=function(){var e;return e=t.defer(),y.get().then(function(t){return e.resolve(t.data)},function(t){return e.reject(t)}),e.promise},l=function(r){var n,o;return n=t.defer(),o=e.one("users"),o.id=r||"me",o.get().then(function(e){return n.resolve(e.data)},function(e){return n.reject(e.error)}),n.promise},d=function(r){var n,o;return n=t.defer(),o=e.one("users"),o.id=r||"me",o.get().then(function(e){return n.resolve(e)},function(e){return n.reject(e)}),n.promise},h=function(r){return function(){var n,o;return n=t.defer(),f()?(n.resolve(r.user),n.promise):r.deferreds.me?r.deferreds.me.promise:(r.deferreds.me=n,o=e.one("users"),o.id="me",o.get().then(function(e){return r.unauthorized=!1,r.user=e.data,r.deferreds.me.resolve(e.data),delete r.deferreds.me},function(e){return r.deferreds.me.reject(),delete r.deferreds.me}),r.deferreds.me.promise)}}(this),c=function(e){return function(){var r;return r=t.defer(),f()?r.resolve(e.user.roles):h().then(function(e){return r.resolve(e.roles)},function(){return r.reject()}),r.promise}}(this),u=function(r){return function(n){var o,s;return o=t.defer(),s=e.one("users").one("interests"),s.id=n||r.user.id,s.get().then(function(e){return o.resolve(e)},function(e){return o.reject(e)}),o.promise}}(this),p=function(r){var n,o;return console.log(r),o=e.one("users"),n=t.defer(),Object.assign(o,r.data[0]),r.put().then(function(e){return 422===e.status?n.reject(e.data):(console.log("golden!"),n.resolve(e.data.data))}),n.promise},m=function(r){return function(){var n;return n=t.defer(),e.all("users").one("logout").remove().then(function(e){return r.user=null,console.log(r.user),r.unauthorized=!0,n.resolve(e)},function(e){return n.reject(e)}),n.promise}}(this),i=function(r){return function(n){var o,s;return o=t.defer(),s=e.one("users"),s.id=n,s.remove().then(function(e){return 401===e.status?(r.unauthorized=!0,o.reject(e.data)):o.resolve()}),o.promise}}(this),f=function(e){return function(){return!e.unauthorized&&null!=e.user}}(this),{getAll:a,getUser:l,getUserPacket:d,getRoles:c,getInterests:u,retrieveUser:h,updateUser:p,logout:m,deleteUser:i,registerUser:g,isAuthenticated:f}}]),angular.module("mediMeet").controller("CompanyListCtrl",["$state","Company","$scope",function(e,t,r){return this.unlocked=!1,this.resetSettings=function(e){return function(){return e.finishedLoading=!1,e.companyList=[]}}(this),this.resetSettings(),this.init=function(e){return function(){return t.getAll().then(e.compsReceived,function(){return console.log("Couldn't retrieve companies.")})}}(this),this.compsReceived=function(e){return function(t){return e.finishedLoading=!0,e.companyList=angular.copy(t),console.log(e.companyList)}}(this),this.getCompany=function(t){return e.go("root.companies.company",{id:t})},this.approveCompany=function(e){return t.approve(e.id).then(function(t){return e.validated=!0},function(e){return console.log(e)})},this.deleteCompany=function(e){return function(r){return t.destroy(r.id).then(function(t){return e.companyList.splice(e.companyList.indexOf(r),1)},function(e){return console.log(e)})}}(this),this.init(),this}]),angular.module("mediMeet").controller("InterestListCtrl",["$state","User","Interests","$scope","interest",function(e,t,r,n,o){return this.posts=o,this.edit=function(t){return e.go("root.interest.editinterest",{id:t})},this.viewPost=function(t){return e.go("root.interest.hidden",{id:t})},this.getUser=function(t){return e.go("root.interest",{id:t})},this.deletePost=function(e){return function(t){return r.deleteInterest(t.id).then(function(r){var n;return n=e.posts.indexOf(t),e.posts.splice(n,1)},function(e){return console.log("Error while deleting Post.")})}}(this),this}]),angular.module("mediMeet").controller("UserListCtrl",["$state","User","$scope","users",function(e,t,r,n){return this.resetSettings=function(e){return function(){return e.finishedLoading=!1,e.userList=n}}(this),this.resetSettings(),this.init=function(e){return function(){return e.reverse=!1,t.getAll().then(e.usersReceived,function(){return console.log("Couldn't retrieve userlist.")})}}(this),this.usersReceived=function(e){return function(t){return e.finishedLoading=!0,e.userList=angular.copy(t)}}(this),this.getUser=function(t){return e.go("root.profile",{id:t})},this.deleteUser=function(e){return function(r){return t.deleteUser(r.id).then(function(t){var n;return n=e.userList.indexOf(r),e.userList.splice(n,1)})}}(this),this}]),angular.module("mediMeet").controller("CompaniesCtrl",["Company","list","$state",function(e,t,r){return this.companyList=t,this.viewCompany=function(e){return r.go("root.companies.company",{id:e})},this}]),angular.module("mediMeet").controller("HomeCtrl",["$state","Interests",function(e,t){return console.log("HomeCtrl active."),this.keywords=[],this.init=function(e){return function(){return t.getKeywords().then(function(t){return console.log(t),e.keywords=t},function(e){return console.log(e)})}}(this),this.searchPage=function(t){return e.go("root.explore",{category:t})},this.init(),this}]);var indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("mediMeet").controller("NavCtrl",["$timeout","$scope","mediREST","User","TokenContainer","$state","$rootScope","toaster",function(e,t,r,n,o,s,i,a){return this.form={},this.username="default",this.admin=!1,this.init=function(e){return function(){return e.isAuthenticated=!1,e.setLoggedIn(o.get()),e.setUsername(),e.isAdmin()}}(this),this.login=function(e){return function(){var t;return t=r.one("users").one("login"),t.data={username:e.form.user.username,password:e.form.user.password},console.log(t.data),t.post().then(function(e){return n.user=e.data.user,o.set(e.data.token),i.$broadcast("user:stateChanged")},function(e){if(404===e.status&&a.pop("error","Nicht vorhanden.","Es wurde kein Account mit diesem Accountnamen gefunden."),401===e.status&&"wrong_password"===e.data.error)return a.pop("error","Falsches Passwort","Das eingegebene Passwort war falsch.")})}}(this),this.setUsername=function(e){return function(){if(console.log(e.isAuthenticated),e.isAuthenticated)return n.retrieveUser().then(function(t){return e.username=angular.copy(t.username)},function(e){return this.username="Angemeldet",console.log("setUsername: error")})}}(this),this.setLoggedIn=function(e){return function(t){return e.isAuthenticated=!!t,console.log("Logged In Status: "+e.isAuthenticated)}}(this),this.logout=function(){return n.logout().then(function(){return o.delete(),s.go("root.home")})},this.isAdmin=function(e){return function(){return console.log(n.user),n.user?(console.log(n.user.roles),indexOf.call(n.user.roles,"admin")>=0?e.admin=!0:e.admin=!1):e.admin=!1}}(this),i.$on("user:stateChanged",function(e){return function(t,r,n){return e.setLoggedIn(o.get()),e.setUsername(),e.isAdmin()}}(this)),this.init(),this}]),angular.module("mediMeet").controller("SearchCtrl",["Interests","$stateParams","$state","Keywords","initials","category",function(e,t,r,n,o,s){return this.list=o,this.category=s,this.subcategories=[],this.subfilter,this.page=1,this.init=function(e){return function(){var r,o,s,i,a;for(a=[],r=0,o=(s=n.relations).length;r<o;r++){if((i=s[r]).category===t.category){e.subcategories=i.subcategories;break}a.push(void 0)}return a}}(this),this.viewPost=function(e){return r.go("root.interest.hidden",{id:e})},this.loadMore=function(e){return function(){return console.log("Loading more content"),e.page++}}(this),this.init(),this}]),angular.module("mediMeet").controller("CompanyCtrl",["comp","$state",function(e,t){return this.company=e.company,this.company.posts=e.posts,this.viewInterest=function(e){return t.go("root.interest.hidden",{id:e})},this}]),angular.module("mediMeet").controller("NewCompanyCtrl",["Company","$state",function(e,t){return this.form={company:{}},this.submit=function(r){return function(){return e.createCompany(r.form.company).then(function(e){return t.go("root.admin.companylist")},function(e){return console.log(e)})}}(this),this}]),angular.module("mediMeet").controller("InterestCtrl",["info","$scope","User","$state",function(e,t,r,n){return this.interest=e,this.init=function(e){return function(){return e.interest.user_id===r.user.id?t.myint=!0:t.myint=!1}}(this),this.back=function(e){return function(){return n.go("root.explore",{category:e.interest.category})}}(this),this.init(),this}]),angular.module("mediMeet").controller("InterestEditCtrl",["Interests","$state","$stateParams","Keywords","Helper",function(e,t,r,n,o){return this.categories=n.relations,this.category=null,this.subcategories=[],this.subcategory=null,this.keywords=[],this.form={interest:{}},this.rest={},this.reason="",this.init=function(n){return function(){return e.getInterest(r.id).then(n.postReceived,function(){return t.go("root.admin.users")})}}(this),this.postReceived=function(e){return function(t){var r,n,o,s,i,a,u,c,l;for(e.rest=t,e.form.interest=angular.copy(e.rest.data),n=0,s=(a=e.categories).length;n<s;n++)if((r=a[n]).category===e.form.interest.category){e.category=r,e.subcategories=e.category.subcategories;break}for(c=[],o=0,i=(u=e.subcategories).length;o<i;o++){if((l=u[o]).subcategory===e.form.interest.subcategory){e.subcategory=l,e.keywords=e.subcategory.keywords;break}c.push(void 0)}return c}}(this),this.changeCategory=function(e){return function(){return e.subcategories=e.category.subcategories,e.subcategory=null,e.keywords=[],e.form.interest.keywords=[]}}(this),this.changeSubcategory=function(e){return function(){return e.keywords=e.subcategory.keywords,e.form.interest.keywords=[]}}(this),this.update=function(t){return function(){return t.form.interest.category=t.category.category,t.form.interest.subcategory=t.subcategory.subcategory,t.rest.data=t.form.interest,e.editInterest(t.rest).then(function(e){return o.goBack()},function(e){return console.log(e)})}}(this),this.abort=function(){return o.goBack()},this.deleteInterest=function(){return e.deleteInterest(this.form.interest.id).then(function(){return t.go("root.profile")},function(e){})},this.init(),this}]),angular.module("mediMeet").controller("InterestHiddenCtrl",["$state","$stateParams","$scope",function(e,t,r){return this.mine=r.myint,this.reveal=function(){return console.log("Click"),e.go("root.interest.revealed")},this.edit=function(){return e.go("root.interest.editinterest",{id:t.id})},this}]),angular.module("mediMeet").controller("InterestRevealedCtrl",["contact",function(e){return this.user=e,this.init=function(e){return function(){return Interests.makeContact($stateParams.id).then(function(t){return e.user=angular.copy(t.data),console.log(e.user)})}}(this),this}]),angular.module("mediMeet").controller("NewPostCtrl",["User","Interests","$state","Keywords","Helper",function(e,t,r,n,o){return this.categories=n.relations,this.category=null,this.subcategories=[],this.subcategory=null,this.keywords=[],this.form={interest:{}},this.changeCategory=function(e){return function(){return e.subcategories=e.category.subcategories,e.subcategory=null,e.keywords=[],e.form.interest.keywords=[]}}(this),this.changeSubcategory=function(e){return function(){return e.keywords=e.subcategory.keywords,e.form.interest.keywords=[]}}(this),this.create_post=function(e){return function(){return e.form.interest.category=e.category.category,e.form.interest.subcategory=e.subcategory.subcategory,t.createInterest(e.form.interest).then(function(e){return r.go("root.profile")})}}(this),this.abort=function(){return o.goBack()},this}]);var indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("mediMeet").controller("ProfileCtrl",["User","$state","$stateParams","mydata","posts",function(e,t,r,n,o){return console.log("Profile Controller Active"),this.user=n,this.interestList=o,this.id=r.id,this.canEdit=!1,this.init=function(t){return function(){if(e.user.id===t.user.id||indexOf.call(e.user.roles,"admin")>=0)return t.canEdit=!0}}(this),this.editProfile=function(e){return function(){return t.go("root.profile.edit",{id:e.id})}}(this),this.getInterests=function(t){return function(){if(!t.interestList.length)return e.getInterests(t.id).then(t.gotInterests,function(){return console.log("Error")})}}(this),this.gotInterests=function(e){return function(t){return e.interestList=angular.copy(t.data)}}(this),this.editInterest=function(e){return t.go("root.interest.editinterest",{id:e})},this.init(),this}]),angular.module("mediMeet").controller("ProfileEditCtrl",["$stateParams","$state","User","Helper",function(e,t,r,n){return console.log("userEditCtrl active."),this.form={user:{}},this.regInProgress=!1,this.rest={},this.init=function(n){return function(){return r.getUserPacket(e.id).then(n.userReceived,function(){return t.go("root.admin.users")})}}(this),this.userReceived=function(e){return function(t){return console.log(t),e.rest=t,e.form.user=angular.copy(e.rest.data)}}(this),this.update=function(n){return function(){return n.regInProgress=!0,n.rest.data=n.form.user,r.updateUser(n.rest).then(function(r){return n.submittedForm=!1,t.go("root.profile",{id:e.id})},function(e){return n.regInProgress=!1})}}(this),this.abort=function(){return n.goBack()},this.deleteAccount=function(){return r.deleteUser(this.form.user.id).then(function(){return t.go("root.home"),r.unauthorized=!0,TokenContainer.delete(),$rootScope.$broadcast("user:stateChanged")},function(e){})},this.init(),this}]),angular.module("mediMeet").controller("RegistrationCtrl",["TokenContainer","User","$state","$scope","$rootScope","companies","Helper",function(e,t,r,n,o,s,i){return console.log("RegistrationCtrl active."),this.form={user:{},contact_data:{},company:{}},this.regInProgress=!1,this.errors={},this.companies=s,this.goBack=function(){return i.goBack()},this.register=function(r){return function(){return r.validate()?(r.regInProgress=!0,"Student"!==r.form.user.typus&&(r.form.user.contact_data=r.form.contact_data,r.form.contact_data.company_id||(delete r.form.contact_data.company_id,r.form.company.typus=r.form.user.typus,r.form.company.web=r.form.user.web,r.form.user.company=r.form.company)),t.registerUser(r.form.user).then(function(n){return r.regInProgress=!1,t.user=n.data.user,e.set(n.data.token),t.unauthorized=!1,o.$broadcast("user:stateChanged"),i.goBack()},function(e){return console.log("Register Error"),console.log(e),404===e.status&&console.log("Email not found"),r.regInProgress=!1})):console.log("Validation failed.")}}(this),this.validate=function(e){return function(){var t,r,n,o;return o=!0,e.errors={},n=e.form.user,t=e.form.contact_data,r=e.form.company,n.typus||(e.errors.typus=!0,o=!1),n.username&&n.email&&n.password&&n.password_confirmation===n.password||(n.username||(e.errors.username=!0),n.email||(e.errors.email=!0),n.password||(e.errors.password=!0),n.password_confirmation&&n.password===n.password_confirmation||(e.errors.password_confirmation=!0),o=!1),"Student"!==n.typus&&(t.firstname&&t.lastname&&t.plz&&t.ort&&(t.web||t.fon)||(t.firstname||(e.errors.firstname=!0),t.lastname||(e.errors.lastname=!0),t.plz||(e.errors.plz=!0),t.ort||(e.errors.ort=!0),t.web||t.fon||(e.errors.web=!0,e.errors.fon=!0),o=!1),t.company_id||(r.name||(e.errors.company.name=!0,o=!1),r.description||(e.errors.company.description=!0,o=!1))),o}}(this),this}]),angular.module("mediMeet").factory("badrequestHandler",["$injector",function(e){return function(e,t){return t.reject(e),t.promise}}]),angular.module("mediMeet").factory("conflictHandler",["$injector",function(e){return function(e,t){return t.reject(e),t.promise}}]),angular.module("mediMeet").factory("forbiddenHandler",["$injector",function(e){return function(e,t){return t.reject(e),t.promise}}]),angular.module("mediMeet").factory("notfoundHandler",["$injector",function(e){return function(e,t){return t.reject(e),t.promise}}]),angular.module("mediMeet").factory("unauthorizedHandler",["$injector",function(e){return function(t,r){var n,o;return n=e.get("TokenContainer"),o=e.get("$state"),"token_expired"===t.data.error.error.name?(n.delete(),o.go("root.home")):"invalid_token"===t.data.error.error.name&&(n.delete(),o.go("root.register")),r.reject(t),r.promise}}]),angular.module("mediMeet").factory("responseInterceptor",["$q","$injector",function(e,t){return{responseError:function(r){var n;switch(n=e.defer(),r.status){case 400:return t.get("badrequestHandler")(r,n);case 401:return t.get("unauthorizedHandler")(r,n);case 403:return t.get("forbiddenHandler")(r,n);case 404:return t.get("notfoundHandler")(r,n);case 409:return t.get("conflictHandler")(r,n);default:return console.log("Other Error"),n.reject(r),n.promise}return r}}}]),angular.module("mediMeet").factory("tokenInterceptor",["TokenContainer","Rails",function(e,t){return{request:function(t){var r;return 0===t.url.indexOf("/api/v1/")&&(r=e.get())&&(t.headers.Authorization="Bearer "+r),t}}}]);